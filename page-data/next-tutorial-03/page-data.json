{"componentChunkName":"component---src-templates-post-jsx","path":"/next-tutorial-03/","result":{"data":{"site":{"siteMetadata":{"title":"joy.blog"}},"markdownRemark":{"id":"81067629-51a8-508c-a80f-6006f4f32da6","excerpt":"âœ¨ Next-Authë€? Next.jsì—ì„œ ì†Œì…œ ë¡œê·¸ì¸ ê¸°ëŠ¥ì„ ì‰½ê²Œ ì¶”ê°€í•˜ê³  ê´€ë¦¬í•  ìˆ˜ ìˆëŠ” Node.js ë¼ì´ë¸ŒëŸ¬ë¦¬ (Authentication)ğŸ“ Next-Auth Docs ë°”ë¡œê°€ê¸° Installation ğŸ” Next Auth ì„¤ì •í•˜ê¸° 1. Google OAuth ì¸ì¦ ì •ë³´ ë°œê¸‰ Next Authë¥¼ ì„¤ì •í•˜ê¸°ì— ì•ì„œ ì‚¬ìš©í•˜ê³ ì í•˜ëŠ” APIì˜ Clientâ€¦","html":"<h2>âœ¨ Next-Authë€?</h2>\n<blockquote>\n<p>Next.jsì—ì„œ ì†Œì…œ ë¡œê·¸ì¸ ê¸°ëŠ¥ì„ ì‰½ê²Œ ì¶”ê°€í•˜ê³  ê´€ë¦¬í•  ìˆ˜ ìˆëŠ” Node.js ë¼ì´ë¸ŒëŸ¬ë¦¬ (Authentication)<br/>ğŸ“ <a href=\"https://next-auth.js.org/getting-started/example\">Next-Auth Docs ë°”ë¡œê°€ê¸°</a></p>\n</blockquote>\n<h3>Installation</h3>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">npm</span> <span class=\"token function\">install</span> next-auth</code></pre></div>\n<h2>ğŸ” Next Auth ì„¤ì •í•˜ê¸°</h2>\n<h3>1. Google OAuth ì¸ì¦ ì •ë³´ ë°œê¸‰</h3>\n<p>Next Authë¥¼ ì„¤ì •í•˜ê¸°ì— ì•ì„œ ì‚¬ìš©í•˜ê³ ì í•˜ëŠ” APIì˜ Client IDì™€ Keyë¥¼ ë°œê¸‰ë°›ëŠ”ë‹¤. ğŸ‘‰<a href=\"https://devjoylee.github.io/google-auth-clientid/\">Google OAuth Client ID ë°œê¸‰ ë°©ë²•</a></p>\n<h3>2. í™˜ê²½ ë³€ìˆ˜ ì„¤ì •</h3>\n<p>ë°œê¸‰ë°›ì€ Google OAuth í´ë¼ì´ì–¸íŠ¸ ì •ë³´ë¥¼ <code class=\"language-text\">.env.local</code> íŒŒì¼ì— ì•„ë˜ì™€ ê°™ì´ ì¶”ê°€í•œë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">GOOGLE_CLIENT_ID=7800994348....\nGOOGLE_CLIENT_SECRET=GOCSPX....</code></pre></div>\n<h3>3. Next Auth API ë§Œë“¤ê¸°</h3>\n<p>page í´ë” ë‚´ì— <code class=\"language-text\">api/auth/[...nextauth].js</code> íŒŒì¼ì„ ë§Œë“¤ê³  ì•„ë˜ ì½”ë“œë¥¼ ì¶”ê°€í•œë‹¤. <br/>ì´ íŒŒì¼ì€ <code class=\"language-text\">/api/auth/*</code> ì˜ ê²½ë¡œë¡œ ìš”ì²­ë˜ëŠ” ëª¨ë“  requestë¥¼ ì²˜ë¦¬í•œë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">import</span> NextAuth <span class=\"token keyword\">from</span> <span class=\"token string\">'next-auth'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> GoogleProvider <span class=\"token keyword\">from</span> <span class=\"token string\">'next-auth/providers/google'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token function\">NextAuth</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// Configure one or more authentication providers</span>\n  <span class=\"token literal-property property\">providers</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token function\">GoogleProvider</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n      <span class=\"token literal-property property\">clientId</span><span class=\"token operator\">:</span> process<span class=\"token punctuation\">.</span>env<span class=\"token punctuation\">.</span><span class=\"token constant\">GOOGLE_CLIENT_ID</span><span class=\"token operator\">!</span><span class=\"token punctuation\">,</span>\n      <span class=\"token literal-property property\">clientSecret</span><span class=\"token operator\">:</span> process<span class=\"token punctuation\">.</span>env<span class=\"token punctuation\">.</span><span class=\"token constant\">GOOGLE_CLIENT_SECRET</span><span class=\"token operator\">!</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    <span class=\"token comment\">// add more providers here</span>\n  <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h3>4. Next.jsì— nextauth ì—°ê²°í•˜ê¸°</h3>\n<p>ì•„ë˜ì™€ ê°™ì´ next-authê°€ ì œê³µí•˜ëŠ” Providerë¡œ ì»´í¬ë„ŒíŠ¸ë¥¼ ê°ì‹¸ì£¼ë©´ next.js ë‚´ ëª¨ë“  ì»´í¬ë„ŒíŠ¸ì—ì„œ useSession hooksë¥¼ í™œìš©í•˜ì—¬ session ì •ë³´ì— ì ‘ê·¼í•  ìˆ˜ ìˆê²Œ ëœë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">//_app.js</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> SessionProvider <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"next-auth/react\"</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">MyApp</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> Component<span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">pageProps</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> session<span class=\"token punctuation\">,</span> <span class=\"token operator\">...</span>pageProps <span class=\"token punctuation\">}</span> <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token operator\">&lt;</span>SessionProvider session<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>session<span class=\"token punctuation\">}</span><span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>Component <span class=\"token punctuation\">{</span><span class=\"token operator\">...</span>pageProps<span class=\"token punctuation\">}</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>SessionProvider<span class=\"token operator\">></span>\n  <span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h3>5. ì»´í¬ë„ŒíŠ¸ì— nextAuth ì¶”ê°€í•˜ê¸°</h3>\n<ul>\n<li>useSession Hook</li>\n</ul>\n<p>ë¡œê·¸ì¸ ì—¬ë¶€ë¥¼ ì•Œë ¤ì£¼ëŠ” hookìœ¼ë¡œ ë¡œê·¸ì¸ ì—¬ë¶€ì— ë”°ë¼ ë°°ì—´ì˜ <strong>ì²«ë²ˆì§¸ ì¸ìëŠ” ìœ ì € ì •ë³´, ë‘ë²ˆì¨° ì¸ìë¡œëŠ” loading ìƒíƒœ</strong>ë¥¼ return í•œë‹¤. ì•„ë˜ ì½”ë“œëŠ” session ë³€ìˆ˜ë¡œ ë¡œê·¸ì¸ ìƒíƒœë¥¼ í™•ì¸í•˜ê³  ë¡œê·¸ì¸/ë¡œê·¸ì•„ì›ƒ ë²„íŠ¼ì„ ì¶œë ¥í•œë‹¤.</p>\n<ul>\n<li>signIn, signOut í•¨ìˆ˜</li>\n</ul>\n<p>signIn, signOut í•¨ìˆ˜ëŠ” next authì—ì„œ ì œê³µí•´ì£¼ëŠ” í•¨ìˆ˜ë¡œ í•´ë‹¹ í•¨ìˆ˜ë¥¼ ì‹¤í–‰í•˜ë©´ next-authê°€ ë§Œë“¤ì–´ ë†“ì€ ë¡œê·¸ì¸ í˜ì´ì§€ í˜¹ì€ ë¡œê·¸ì•„ì›ƒ í˜ì´ì§€ë¡œ ì´ë™í•œë‹¤. ğŸ‘‰ <a href=\"https://next-auth.js.org/configuration/pages\">signIn &#x26; signOut ë§í¬ì„¤ì •í•˜ê¸°</a></p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// index.js</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> signIn<span class=\"token punctuation\">,</span> signOut<span class=\"token punctuation\">,</span> useSession <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'next-auth/client'</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token keyword\">function</span> <span class=\"token function\">Page</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span> session<span class=\"token punctuation\">,</span> loading <span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useSession</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>loading<span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span> <span class=\"token operator\">&lt;</span>div<span class=\"token operator\">></span>loading<span class=\"token operator\">...</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">return</span> <span class=\"token operator\">&lt;</span><span class=\"token operator\">></span>\n    <span class=\"token punctuation\">{</span><span class=\"token operator\">!</span>session <span class=\"token operator\">&amp;&amp;</span>\n      Not signed <span class=\"token keyword\">in</span> <span class=\"token operator\">&lt;</span>br<span class=\"token operator\">/</span><span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>button onClick<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">signIn</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token operator\">></span>Sign <span class=\"token keyword\">in</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>button<span class=\"token operator\">></span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">{</span>\n      session <span class=\"token operator\">&amp;&amp;</span>\n      Signed <span class=\"token keyword\">in</span> <span class=\"token keyword\">as</span> <span class=\"token punctuation\">{</span>session<span class=\"token punctuation\">.</span>user<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">}</span> <span class=\"token operator\">&lt;</span>br<span class=\"token operator\">/</span><span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>button onClick<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">signOut</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token operator\">></span>Sign out<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>button<span class=\"token operator\">></span>\n    <span class=\"token punctuation\">}</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span><span class=\"token operator\">></span>\n  <span class=\"token punctuation\">}</span></code></pre></div>\n<br />\n<br />\n<blockquote>\n<p>REFERENCE<br /> NextAuth ê³µì‹ë¬¸ì„œ <a href=\"https://next-auth.js.org/\">https://next-auth.js.org/</a></p>\n</blockquote>","frontmatter":{"title":"Next-Authë¡œ Google ë¡œê·¸ì¸ ê¸°ëŠ¥ êµ¬í˜„","date":"November 19, 2022","update":"November 19, 2022","tags":["NextJS","react"],"series":"NextJS"},"fields":{"slug":"/next-tutorial-03/","readingTime":{"minutes":2.745}}},"seriesList":{"edges":[{"node":{"id":"4f12cffb-fcfd-5035-af57-53d4b7f438bd","fields":{"slug":"/next-tutorial-01/"},"frontmatter":{"title":"NextJS ì‘ë™ ì›ë¦¬ì™€ íŒŒì¼ êµ¬ì¡°"}}},{"node":{"id":"d6aa89ae-0d27-5829-9b78-f3fb7b803414","fields":{"slug":"/next-tutorial-02/"},"frontmatter":{"title":"NextJS ver.13 íŠ¹ì§• ì‚´í´ë³´ê¸°"}}},{"node":{"id":"81067629-51a8-508c-a80f-6006f4f32da6","fields":{"slug":"/next-tutorial-03/"},"frontmatter":{"title":"Next-Authë¡œ Google ë¡œê·¸ì¸ ê¸°ëŠ¥ êµ¬í˜„"}}},{"node":{"id":"90921c61-72d1-55bc-9932-3d0a3ae55f92","fields":{"slug":"/next-tutorial-04/"},"frontmatter":{"title":"Next-Auth + MongoDB ë¡œê·¸ì¸ ìœ ì €ê°’ ì €ì¥í•˜ê¸°"}}},{"node":{"id":"715017e0-660b-5773-ac5c-b5b525c5b968","fields":{"slug":"/next-tutorial-05/"},"frontmatter":{"title":"NextJS ver.14: ì„œë²„ ì»´í¬ë„ŒíŠ¸ì™€ ì„œë²„ ì•¡ì…˜"}}}]},"previous":{"fields":{"slug":"/next-tutorial-02/"},"frontmatter":{"title":"NextJS ver.13 íŠ¹ì§• ì‚´í´ë³´ê¸°"}},"next":{"fields":{"slug":"/node-tutorial-04/"},"frontmatter":{"title":"[Node] Server Authentication (Session vs JWT)"}}},"pageContext":{"id":"81067629-51a8-508c-a80f-6006f4f32da6","series":"NextJS","previousPostId":"d6aa89ae-0d27-5829-9b78-f3fb7b803414","nextPostId":"00edc97c-e36c-55a1-9d91-6fc009e4cbff"}},"staticQueryHashes":[],"slicesMap":{}}